<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="신하늘의 블로그 포스트 페이지입니다." />
    <title>포스트 - 투린의 포스트</title>
    <meta property="og:image" content="images/embed_image.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="banner with-image">
      <div class="banner-image-container">
        <img src="images/banner.gif" alt="배너 이미지" class="banner-image">
      </div>
    </header>
    
    <section class="intro-section">
      <div class="container">
        <h1>투린의 포스트</h1>
        <p>생각과 경험을 공유하는 공간입니다</p>
        <div class="social-links">
          <a href="https://github.com/turin-dev" target="_blank" aria-label="GitHub"><i class="fab fa-github"></i></a>
          <a href="https://www.youtube.com/@turin-dev" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
          <a href="https://open.spotify.com/user/31k5mjulm2dp5nxyobaukxz4wbo4?si=5d649ed743c04181" target="_blank" aria-label="Spotify"><i class="fab fa-spotify"></i></a>
          <a href="discord://-/users/959784288717520937" title="Discord"><i class="fab fa-discord"></i></a>
        </div>
      </div>
    </section>
    <nav id="main-nav">
      <div class="container">
        <ul>
          <li><a href="index.html"><i class="fas fa-user"></i> 프로필</a></li>
          <li><a href="portfolio.html"><i class="fas fa-briefcase"></i> Discord 관리자 경력</a></li>
          <li><a href="posts.html" class="active"><i class="fas fa-pen"></i> 포스트</a></li>
          <li><a href="#" id="dark-mode-toggle"><i class="fas fa-moon"></i> 다크 모드</a></li>
        </ul>
      </div>
    </nav>
    <main>
      <div class="container">
        <section id="posts">
          <h2><i class="fas fa-pen"></i> 최근 포스트</h2>
          <p class="section-intro">제 생각과 경험을 공유하는 블로그 포스트입니다. 다양한 주제에 대한 이야기를 나눕니다.</p>
          
          <div class="posts-container" id="posts-list">
            <p class="no-posts">작성된 포스트가 없습니다.</p>
          </div>
        </section>
      </div>
    </main>
    

    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-links">
            <a href="index.html">프로필</a>
            <a href="portfolio.html">Discord 관리자 경력</a>
            <a href="posts.html">포스트</a>
          </div>
          <div class="social-links">
            <a href="https://github.com/turin-dev" target="_blank" aria-label="GitHub"><i class="fab fa-github"></i></a>
            <a href="https://www.youtube.com/@turin_dev" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
            <a href="https://open.spotify.com/user/31k5mjulm2dp5nxyobaukxz4wbo4?si=5d649ed743c04181" target="_blank" aria-label="Spotify"><i class="fab fa-spotify"></i></a>
            <a href="discord://-/users/959784288717520937" title="Discord"><i class="fab fa-discord"></i></a>
          </div>
          <p>&copy; 2025 turin_offical | All Rights Reserved</p>
        </div>
      </div>
    </footer>
    
    <script>
      // 스크롤 시 네비게이션 바 스타일 변경
      window.addEventListener('scroll', function() {
        const nav = document.getElementById('main-nav');
        if (window.scrollY > 100) {
          nav.classList.add('scrolled');
        } else {
          nav.classList.remove('scrolled');
        }
      });

      // 다크 모드 토글 기능
      const darkModeToggle = document.getElementById('dark-mode-toggle');
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      
      // 로컬 스토리지에서 테마 설정 불러오기
      const savedTheme = localStorage.getItem('theme');

      // 초기 테마 설정 함수
      function applyTheme(theme) {
        if (theme === 'dark') {
          document.body.classList.add('dark-mode');
          darkModeToggle.innerHTML = '<i class="fas fa-sun"></i><span> 라이트 모드</span>'; // 다크 모드일 때 라이트 모드로 전환 버튼
        } else {
          document.body.classList.remove('dark-mode');
          darkModeToggle.innerHTML = '<i class="fas fa-moon"></i><span> 다크 모드 </span>'; // 라이트 모드일 때 다크 모드로 전환 버튼 (글자 수 맞춤)
        }
      }

      if (savedTheme) {
        applyTheme(savedTheme);
      } else if (prefersDarkScheme.matches) {
        // 로컬 스토리지에 없으면 시스템 설정 따르기
        applyTheme('dark');
      } else {
        applyTheme('light');
      }

      // 버튼 클릭 시 다크/라이트 모드 토글
      darkModeToggle.addEventListener('click', function(e) {
        e.preventDefault();
        if (document.body.classList.contains('dark-mode')) {
          applyTheme('light');
          localStorage.setItem('theme', 'light');
        } else {
          applyTheme('dark');
          localStorage.setItem('theme', 'dark');
        }
      });
    </script>
  
    <!-- DB 목록 불러오기 (기존 코드 유지) -->
    <script>
    (async function () {
      const API = "postgresql://postgres:NwanzjapZJAqvQiMsNiBwGUQHAJqvzeF@metro.proxy.rlwy.net:17807/railway"; // ← 여기를 네 공개 URL로 교체
      const listEl = document.getElementById("posts-list");
      if (!listEl) return;

      try {
        const res = await fetch(`${API}/api/posts?limit=50&offset=0`, { cache: "no-store" });
        if (!res.ok) throw new Error("목록 불러오기 실패");
        const posts = await res.json();

        if (!posts.length) {
          // 아무 글 없으면 기존 문구 유지
          return;
        }

        listEl.innerHTML = posts.map(p => `
          <article class="post-card">
            <h3 class="title"><a href="post.html?id=${p.id}">${p.name}</a></h3>
            <div class="sub"><time>${new Date(p.created_at).toLocaleDateString()}</time></div>
            <p class="excerpt">${(p.excerpt || p.detail || "").replace(/\n/g,' ').slice(0, 150)}...</p>
            <a class="readmore" href="post.html?id=${p.id}">자세히 보기 →</a>
          </article>
        `).join("");
      } catch (e) {
        console.error(e);
        // 실패 시 기존 '작성된 포스트가 없습니다.' 유지
      }
    })();
    </script>

</body>
</html>